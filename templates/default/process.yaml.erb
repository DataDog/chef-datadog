init_config:

instances:
#  - name: (mandatory) STRING Is the display name of the check, it will be system.name.processes
#    search_string: (mandatory) LIST OF STRINGS If one of the element in the list matches, 
#                    return the counter of all the processes that contain the string
#    exact_match: (optional) True/False, default to False, if you want to look for an arbitrary
#                 string, use exact_match: False, unless use the exact base name of the process
#    
# Examples:
#
# - name: ssh
#   search_string: ['ssh', 'sshd']
#   exact_match: False
#
# to add to role, add a "process" parameter to the datadog overrides:
#{
#  "datadog" : {
#  "process" : [
#    {
#      "name" : "ssh",
#      "search_string" : ['ssh', 'sshd'],
#      "exact_match" : "False"
#    }
#  ]
#}
#

<% node['datadog']['process'].each do |p| %>
  - name: <%= p["name"] %>
    search_string: <%= p["search_string"] %>
    <% if p.key?("exact_match") -%>
    exact_match: <%= p["exact_match"] %>
	  <% end %>
<% end %>