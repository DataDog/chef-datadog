init_config:
# To notify on every service, set a list of notified uses here.
#
#    notify:
#        - user1@example.com
#        - pagerduty
<% if @init_config.key?("notify") -%>
    notify:
      <% @init_config["notify"].each do |k| -%>
      - <%= k %>
      <% end -%>
<% end -%>

instances:
<% @instances.each do |i| -%>
  - name: <%= i['name'] %>
    url: <%= i['url'] %>
    <% if i.key?('timeout') -%>timeout: <%= i['timeout'] %><% end -%>
    <% if i.key?('username') && i.key?('password') -%>
    username: <%= i['username'] %>
    password: <%= i['password'] %>
    <% end -%>
    <% if i.key?('threshold') -%>threshold: <%= i['threshold'] %><% end -%>
    <% if i.key?('window') -%>window: <%= i['window'] %><% end -%>
    <% if i.key?('include_content') -%>include_content: <%= i['include_content'] %><% end -%>
    <% if i.key?('collect_response_time') -%>collect_response_time: <%= i['collect_response_time'] %><% end -%>
    <% if i.key?('disable_ssl_validation') -%>disable_ssl_validation: <%= i['disable_ssl_validation'] %><% end -%>
    <% if i.key?('skip_event') -%>skip_event: <%= i['skip_event'] %><% end -%>
    <% if i.key?('tags') -%>
    tags:
      <% i['tags'].each do |k| -%>
      - <%= k %>
      <% end -%>
    <% end -%>
    <% if i.key?('headers') -%>
    headers:
      <% i['notify'].each_pair do |k,v| -%>
        <%= k %>: <%= v %>
      <% end -%>
    <% end -%>
    <% if i.key?('notify') -%>
    notify:
      <% i['notify'].each do |k| -%>
      - <%= k %>
      <% end -%>
    <% end -%>

<% end -%>